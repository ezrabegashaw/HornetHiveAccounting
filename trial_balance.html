<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="UTF-8">
  <title>Hornet Hive Accounting - Trial Balance</title>
  <link rel="stylesheet" href="main.css">
  <style>
    .tb-header {
      text-align:center;
      margin-bottom:1.5rem;
    }
    .tb-header h1 {
      margin:0;
      font-size:1.6rem;
      font-weight:600;
    }
    .tb-header h2 {
      margin:.1rem 0;
      font-size:1.25rem;
      font-weight:500;
    }
    .tb-header p {
      margin:0;
      color:#6b7280;
    }
    .table-wrap {
      background:#ffffff;
      border-radius:10px;
      padding:1rem;
      box-shadow:0 8px 24px rgba(15,23,42,.06);
    }
    table.tb-table {
      width:100%;
      border-collapse:collapse;
    }
    .tb-table thead th {
      text-align:left;
      padding:.5rem .75rem;
      border-bottom:1px solid #e5e7eb;
      background:#f9fafb;
      font-weight:600;
    }
    .tb-table tbody td,
    .tb-table tfoot td {
      padding:.45rem .75rem;
      border-bottom:1px solid #f3f4f6;
      font-size:.95rem;
    }
    .tb-table tbody tr:hover {
      background:#f9fafb;
    }
    .tb-table td.num {
      text-align:right;
      font-family:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    .tb-table tfoot td {
      font-weight:700;
      background:#f1f5f9;
      border-top:2px solid #111827;
    }
    .tb-ok {
      margin-top:.5rem;
      font-size:.9rem;
      color:#16a34a;
      font-weight:600;
    }
    .tb-warn {
      margin-top:.5rem;
      font-size:.9rem;
      color:#b91c1c;
      font-weight:600;
    }
    .tb-account-link {
      color:#111827;
      text-decoration:none;
    }
    .tb-account-link:hover {
      text-decoration:underline;
    }
  </style>
</head>

<body class="has-sidebar">
<header class="topbar">
  <div class="datetime" id="dateTime"></div>
  <div class="user">
    <img id="userAvatar" src="profile.png" alt="User">
    <span id="userName"></span>
  </div>
</header>

<script>
  const name = localStorage.getItem('username') || 'User';
  const el = document.getElementById('userName');
  if (el) el.textContent = name;

  function updateClock(){
    const now = new Date();
    const options = {
      weekday:'short', year:'numeric', month:'short', day:'numeric',
      hour:'2-digit', minute:'2-digit', second:'2-digit'
    };
    document.getElementById('dateTime').textContent =
      now.toLocaleString(undefined, options);
  }
  updateClock();
  setInterval(updateClock,1000);
</script>

<div class="app">
  <aside class="sidebar">
    <div class="brand">
      <img src="HHAlogo.jpg" alt="HHA Logo"><span>HHA</span>
    </div>
    <ul class="nav">
      <li><a href="Dashboard.html">Dashboard</a></li>
      <li><a href="ChartOfAccounts.html">Chart of Accounts</a></li>
      <li><a href="Accounts.html">Accounts</a></li>
      <li><a href="journal.html">Journalize</a></li>
      <li><a href="trial_balance.html" aria-current="page">Trial Balance</a></li>
      <li><a href="#income">Income Statement</a></li>
      <li><a href="#balance">Balance Sheet</a></li>
      <li><a href="#retained">Statement of Retained Earnings</a></li>
    </ul>
    <div class="sidebar-footer">
      <button class="btn" id="logoutBtn">Logout</button>
    </div>
  </aside>

  <main class="main">
    <div class="tb-header">
      <h1>Hornet Hive Accounting</h1>
      <h2>Trial Balance</h2>
      <p id="tbAsOf">As of <!-- filled by JS --></p>
    </div>

    <div class="table-wrap">
      <table class="tb-table">
        <thead>
          <tr>
            <th>Account</th>
            <th class="num">Debit</th>
            <th class="num">Credit</th>
          </tr>
        </thead>
        <tbody id="tbBody">
          <tr><td colspan="3" style="text-align:center;">Loadingâ€¦</td></tr>
        </tbody>
        <tfoot>
          <tr>
            <td>Total</td>
            <td class="num" id="tbTotalDebit">0.00</td>
            <td class="num" id="tbTotalCredit">0.00</td>
          </tr>
        </tfoot>
      </table>
      <div id="tbMessage"></div>
    </div>
  </main>
</div>

<!-- Supabase + auth -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="auth.js"></script>
<script src="trial_balance.js"></script>

<script>
  // Logout
  document.getElementById('logoutBtn')?.addEventListener('click', async () => {
    try {
      if (window.supabaseClient?.auth) await window.supabaseClient.auth.signOut();
    } catch(e){}
    localStorage.removeItem('username');
    location.href = 'HornetHiveLogin.html';
  });
</script>
</body>
</html>
