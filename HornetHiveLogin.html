<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hornet Hive Accounting</title>
  <link rel="stylesheet" href="HornetHiveLogin.css">
</head>
<body>
  <header>
    <h1>Hornet Hive Accounting</h1>
  </header>

  <main>
    <div class="login-container">
      <!-- Logo -->
      <div class="logo">⬢⬢⬢</div>
      <h2>HHA</h2>

      <!-- Auth Form -->
      <form id="auth-form">
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Password" required>

        <div class="links">
          <a href="CreateUser.html" id="signup-link">Create new user</a>
          <a href="#" id="login-link">Login</a>
        </div>

        <button type="submit" class="login-btn">Login</button>
      </form>
    </div>
  </main>

  <!-- Supabase Script -->
  <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js";

    // Project URL + anon key
    const SUPABASE_URL = "https://rsthdogcmqwcdbqppsrm.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJzdGhkb2djbXF3Y2RicXBwc3JtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwNTY3NDcsImV4cCI6MjA3MTYzMjc0N30.EoOxjSIjGHbw6ltNisWYq6yKXdrOfE6XVdh5mERbrSY";

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // DOM elements
    const authForm = document.getElementById("auth-form");
    const signupLink = document.getElementById("signup-link");
    const loginLink = document.getElementById("login-link");
    let mode = "login"; // default

    // Switch to login mode
    loginLink.addEventListener("click", (e) => {
      e.preventDefault();
      mode = "login";
      document.querySelector(".login-btn").textContent = "Login";
    });

    // Handle login/signup
    authForm.addEventListener("submit", async (event) => {
      event.preventDefault();

      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      if (mode === "login") {
        const { data, error } = await supabase.auth.signInWithPassword({ email, password });
        if (error) {
          alert("Login failed: " + error.message);
        } else {
          alert("✅ Login successful!");
          console.log("User:", data.user);
        }
      } else if (mode === "signup") {
        const { data, error } = await supabase.auth.signUp({ email, password });
        if (error) {
          alert("Signup failed: " + error.message);
        } else {
          alert("✅ Signup successful! Check your email for confirmation.");
          console.log("New user:", data.user);
        }
      }
    });
  </script>
</body>
</html>
